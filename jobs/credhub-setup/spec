---
name: credhub-setup
description: Sets up the application security groups required for CredHub

templates:
  bpm.yml.erb:    config/bpm.yml
  run.erb:        bin/run
  post-start.erb: bin/post-start
  drain.erb:      bin/drain
  uaa-ca.crt.erb: uaa-ca.crt
  cc-ca.crt.erb:  cc-ca.crt

packages:
- credhub_setup

consumes:
- name: cloud_controller_https_endpoint
  type: cloud_controller_https_endpoint

properties:
  credhub_setup.name:
    description: Name of the service to create the rule for.
  credhub_setup.ports:
    description: Ports for the service to expose.
  credhub_setup.oauth_client:
    description: OAuth client to use for UAA authorization.
    default: credhub_setup_client
  credhub_setup.oauth_secret:
    description: OAuth client secret to use for UAA authorization.
  uaa.ca_cert:
    description: CA certificate used to verify the UAA SSL connection.
    example: |
      ---- BEGIN CERTIFICATE ----
      ---- END CERTIFICATE ----
  uaa.internal_host:
    description: Hostname UAA is listening on internally.
    default: uaa.service.cf.internal
  uaa.ssl.port:
    description: Port UAA is listening on internally.
    default: 8443
